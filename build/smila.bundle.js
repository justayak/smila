!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Smila=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var Future=require("future-callbacks");var Utils=require("./Utils.js");var spriteCache={};var SPRITE_LOAD_TIMEOUT=2e3;function loadSprite(spriteData,future){Utils.log("loading sprite "+spriteData.key);var img=new Image;if(spriteData.key in spriteCache){Utils.log("load sprite "+spriteData.key+" from Cache");setTimeout(function(){future.execSuccess()},1)}else{img.onload=function(){Utils.log("sprite "+spriteData.key+"loaded");var canvas=document.createElement("canvas");canvas.width=img.width;canvas.height=img.height;var context=canvas.getContext("2d");context.drawImage(img,0,0);spriteCache[spriteData.key]=canvas;future.execSuccess()};img.onerror=function(err){Utils.log("could not load img "+spriteData.key,err);future.execFailure(err)};if(typeof spriteData.base64!=="undefined"){Utils.log("load sprite "+spriteData.key+" from base64");img.src=spriteData.base64}else{Utils.log("load sprite "+spriteData.key+" from URL: "+spriteData.url);img.src=spriteData.src}}}module.exports={put:function(spriteData){var future;if(Array.isArray(spriteData)){future=Future.create(this,spriteData.length,SPRITE_LOAD_TIMEOUT);spriteData.forEach(function(element){loadSprite(element,future)})}else{future=Future.create();loadSprite(spriteData,future)}return future}}},{"./Utils.js":6,"future-callbacks":7}],2:[function(require,module,exports){"use strict";var Utils=require("yutils");var Scene=require("./Scene.js");function Renderer(domId,options){if(!Utils.isString(domId)){throw new Error("DomID must be a String")}if(!Utils.isDefined(options)){options={}}var verbose="verbose"in options?options.verbose:false;var parent=document.getElementById(domId);var position=parent.style.position;if(position.length===0){parent.style.position="relative"}var canvas=document.createElement("canvas");canvas.height=parent.clientHeight;canvas.width=parent.clientWidth;this.mousePosition={x:0,y:0};this.dimension={w:parent.clientWidth,h:parent.clientHeight};this.state=null;if(verbose&&typeof State!=="undefined"){this.stats=new State;this.stats.domElement.style.position="absolute";this.stats.domElement.style.left="0px";this.stats.domElement.style.top="0px";parent.appendChild(this.stats.domElement)}this.context=canvas.getContext("2d");parent.appendChild(canvas)}var sceneCache={};Renderer.prototype.putScene=function(name,options){var future=Future.create();if(name in sceneCache){future.execSuccess(sceneCache[name])}else{var scene=new Scene(options,function(){future.execSuccess(scene)});sceneCache[name]=scene}return future};module.exports=Renderer},{"./Scene.js":3,yutils:8}],3:[function(require,module,exports){"use strict";var Utils=require("yutils");function Scene(options,callback){Utils.assertLength(arguments,2);if("map"in options){}else{}}Scene.prototype.play=function(){console.log("play scene")};module.exports=Scene},{yutils:8}],4:[function(require,module,exports){"use strict";var Scene=require("./Scene.js");var Utils=require("yutils");var cache={};module.exports={create:function(name,options){Utils.assertLength(arguments,2);if(!Utils.isString(name)){throw new Error("first parameter must be a string")}var scene=new Scene(options);cache[name]=scene;return scene}}},{"./Scene.js":3,yutils:8}],5:[function(require,module,exports){"use strict";var SceneLoader=require("./SceneLoader.js");var Renderer=require("./Renderer.js");var DataStore=require("./DataStore.js");module.exports={debug:function(str){console.log(str)},sceneLoader:function(){return SceneLoader},dataStore:function(){return DataStore},renderer:function(domId,options){return new Renderer(domId,options)}}},{"./DataStore.js":1,"./Renderer.js":2,"./SceneLoader.js":4}],6:[function(require,module,exports){"use strict";module.exports={log:function(str,data){if(typeof data==="undefined"){console.log(str)}else{console.log(str,data)}}}},{}],7:[function(require,module,exports){function Future(obj,maxCount,timeout){this.obj=typeof obj==="undefined"?{}:obj;this.successHandler=null;this.failureHandler=null;this.finallyHandler=null;this.finallyCount=0;this.timeout=0;if(typeof maxCount!=="undefined"){if(typeof timeout==="undefined"){throw new Error("timeout must be defined!")}this.timeout=timeout;this.maxCount=maxCount}else{this.maxCount=1}this.timeoutThread=null}Future.prototype.execSuccess=function(){var self=this;var args=arguments;if(this.successHandler===null){setTimeout(function(){if(self.successHandler===null){console.warn("success on function with no success handler")}else{execute(self,"successHandler",args)}},1)}else{execute(this,"successHandler",arguments)}};function execute(future,handlerName,args){future.finallyCount+=1;future[handlerName].apply(future.obj,args);if(future.finallyCount===future.maxCount&&future.finallyHandler!==null){clearInterval(future.timeoutThread);future.finallyHandler.call(future.obj);future.successHandler=null;future.failureHandler=null}}Future.prototype.execFailure=function(){var self=this;var args=arguments;if(this.failureHandler==null){setTimeout(function(){if(self.failureHandler===null){throw new Error("unhandled failure")}else{execute(this,"failureHandler",args)}},1)}else{execute(this,"failureHandler",arguments)}};Future.prototype.success=function(callback){if(this.successHandler==null){this.successHandler=callback}else{throw new Error("Listener is already set!")}return this};Future.prototype.failure=function(callback){if(this.failureHandler==null){this.failureHandler=callback}else{throw new Error("Listener is already set!")}return this};Future.prototype.finally=function(a,b,c){var self=this;if(this.finallyHandler!=null){throw new Error("Listener is already set!")}else{if(isFunction(a)){this.finallyHandler=a;if(this.timeout>0){this.timeoutThread=setTimeout(function(){self.finallyHandler.call(self.obj)},this.timeout)}return this}else if(isNumber(a)&&a>0){this.maxCount=a;if(isNumber(b)){this.timeoutThread=setTimeout(function(){self.finallyHandler.call(self.obj)},b)}else{throw new Error("timeout parameter is missing!")}if(isFunction(c)){self.finallyHandler=c}else{clearTimeout(this.timeoutThread);throw new Error("callback must be a function!")}}else{throw new Error("first param must be number or function!")}}};function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function isFunction(functionToCheck){var getType={};return functionToCheck&&getType.toString.call(functionToCheck)==="[object Function]"}module.exports.create=function(obj,i,t){return new Future(obj,i,t)}},{}],8:[function(require,module,exports){(function(exports){var perf=null;if(typeof performance==="undefined"){perf={}}else{perf=performance}perf.now=perf.now||perf.mozNow||perf.msNow||perf.oNow||perf.webkitNow||Date.now||function(){return(new Date).getTime()};function swap(array,i,j){if(i!==j){var temp=array[i];array[i]=array[j];array[j]=temp}}var getRandomInt=exports.getRandomInt=function(min,max){if(min>max)throw new Error("min must be smaller than max! {"+min+">"+max+"}");return Math.floor(Math.random()*(max-min+1))+min};exports.sample=function(list,n){var result=[],j,i=0,L=n>list.length?list.length:n,s=list.length-1;for(;i<L;i++){j=getRandomInt(i,s);swap(list,i,j);result.push(list[i])}return result};var isString=exports.isString=function(myVar){return typeof myVar==="string"||myVar instanceof String};exports.assertLength=function(arg,nbr){if(arg.length===nbr)return true;else throw new Error("Wrong number of arguments: expected:"+nbr+", but got: "+arg.length)};exports.guid=function(){var d=perf.now();var guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c==="x"?r:r&3|8).toString(16)});return guid};exports.timeDifferenceInMs=function(tsA,tsB){if(tsA instanceof Date){tsA=tsA.getTime()}if(tsB instanceof Date){tsB=tsB.getTime()}return Math.abs(tsA-tsB)};exports.msToS=function(ms){return ms/1e3};exports.isDefined=function(o){if(o===null)return false;if(typeof o==="undefined")return false;return true};exports.cloneArray=function(list){return list.slice(0)};exports.deletePosition=function(list,i){if(i<0||i>=list.length)throw new Error("Out of bounds");list.splice(i,1);return list};var implements=exports.implements=function(o,a){if(Array.isArray(a)){return implements.apply({},[o].concat(a))}var i=1,methodName;while(methodName=arguments[i++]){if(typeof o[methodName]!=="function"){return false}}return true};var isNumber=exports.isNumber=function(o){if(isString(o))return false;return!isNaN(o-0)&&o!==null&&typeof o!=="undefined"&&o!==false};function not(l){return!l}var defines=exports.defines=function(obj,definition){var key=null,type,i=0,L;if(Array.isArray(obj)){L=obj.length;for(;i<L;i++){if(!defines(obj[i],definition)){return false}}}else{for(key in definition){type=definition[key];switch(type){case String:if(not(isString(obj[key]))){console.error("object@"+key+" does not implement "+type+":",obj);return false}break;case Number:if(not(isNumber(obj[key]))){console.error("object@"+key+" does not implement "+type+":",obj);return false}break;default:if(not(obj[key]instanceof type)){console.error("object@"+key+" does not implement "+type+":",obj);return false}break}}}return true};exports.inherit=function(child,parent){child.prototype=Object.create(parent.prototype)}})(typeof exports==="undefined"?this["yUtils"]={}:exports)},{}]},{},[5])(5)});